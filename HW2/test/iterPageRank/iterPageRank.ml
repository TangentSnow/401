open Alcotest
open Pagerank

let g1 =
  [
    ("n2", "n0");
    ("n1", "n4");
    ("n4", "n0");
    ("n1", "n3");
    ("n2", "n1");
    ("n0", "n1");
    ("n3", "n4");
    ("n0", "n4");
    ("n4", "n1");
    ("n4", "n2");
    ("n1", "n0");
  ]

let g2 =
  [
    ("n41", "n23");
    ("n28", "n11");
    ("n9", "n27");
    ("n46", "n30");
    ("n48", "n44");
    ("n8", "n4");
    ("n7", "n36");
    ("n37", "n25");
    ("n8", "n40");
    ("n5", "n46");
    ("n38", "n0");
    ("n21", "n17");
    ("n32", "n40");
    ("n46", "n8");
    ("n22", "n15");
    ("n38", "n34");
    ("n46", "n28");
    ("n9", "n10");
    ("n15", "n11");
    ("n33", "n22");
    ("n6", "n37");
    ("n9", "n34");
    ("n11", "n30");
    ("n4", "n6");
    ("n6", "n10");
    ("n28", "n43");
    ("n35", "n14");
    ("n35", "n44");
    ("n16", "n44");
    ("n8", "n29");
    ("n48", "n2");
    ("n41", "n39");
    ("n28", "n29");
    ("n5", "n0");
    ("n28", "n16");
    ("n5", "n34");
    ("n32", "n47");
    ("n7", "n3");
    ("n38", "n46");
    ("n8", "n48");
    ("n29", "n41");
    ("n1", "n42");
    ("n6", "n0");
    ("n9", "n22");
    ("n4", "n46");
    ("n19", "n14");
    ("n2", "n6");
    ("n28", "n8");
    ("n28", "n27");
    ("n45", "n23");
    ("n19", "n20");
    ("n30", "n19");
    ("n8", "n33");
    ("n7", "n37");
    ("n25", "n24");
    ("n48", "n39");
    ("n42", "n25");
    ("n8", "n21");
    ("n28", "n5");
    ("n22", "n6");
    ("n18", "n6");
    ("n29", "n7");
    ("n14", "n18");
    ("n36", "n44");
    ("n24", "n46");
    ("n45", "n19");
    ("n23", "n26");
    ("n1", "n15");
    ("n1", "n31");
    ("n9", "n31");
    ("n22", "n5");
    ("n11", "n1");
    ("n38", "n8");
    ("n4", "n45");
    ("n32", "n3");
    ("n26", "n28");
    ("n44", "n40");
    ("n2", "n0");
    ("n33", "n42");
    ("n24", "n17");
    ("n32", "n22");
    ("n22", "n1");
    ("n3", "n0");
    ("n28", "n41");
    ("n20", "n19");
    ("n16", "n23");
    ("n41", "n33");
    ("n7", "n0");
    ("n38", "n10");
    ("n6", "n36");
    ("n45", "n7");
    ("n28", "n42");
    ("n41", "n7");
    ("n42", "n34");
    ("n41", "n19");
    ("n29", "n44");
    ("n48", "n7");
    ("n5", "n8");
    ("n28", "n30");
    ("n24", "n20");
    ("n42", "n27");
    ("n42", "n8");
    ("n10", "n24");
    ("n34", "n40");
    ("n12", "n7");
    ("n3", "n26");
    ("n28", "n36");
    ("n32", "n10");
    ("n42", "n40");
    ("n30", "n36");
    ("n22", "n30");
    ("n40", "n22");
    ("n48", "n13");
    ("n24", "n19");
    ("n35", "n30");
    ("n8", "n36");
    ("n45", "n16");
    ("n32", "n42");
    ("n37", "n44");
    ("n11", "n43");
    ("n28", "n10");
    ("n32", "n4");
    ("n16", "n25");
    ("n22", "n20");
    ("n39", "n35");
    ("n37", "n19");
    ("n28", "n40");
    ("n11", "n29");
    ("n23", "n4");
    ("n6", "n23");
    ("n3", "n19");
    ("n15", "n45");
    ("n35", "n8");
    ("n1", "n21");
    ("n32", "n1");
    ("n36", "n23");
    ("n16", "n48");
    ("n41", "n31");
    ("n14", "n46");
    ("n2", "n45");
    ("n7", "n25");
    ("n11", "n27");
    ("n15", "n6");
    ("n15", "n26");
    ("n42", "n48");
    ("n44", "n26");
    ("n16", "n12");
    ("n17", "n7");
    ("n4", "n43");
    ("n16", "n33");
    ("n9", "n44");
    ("n7", "n38");
    ("n28", "n47");
    ("n5", "n31");
    ("n12", "n45");
    ("n33", "n4");
    ("n48", "n46");
    ("n48", "n24");
    ("n22", "n41");
    ("n22", "n0");
    ("n31", "n43");
    ("n44", "n42");
    ("n39", "n33");
    ("n40", "n29");
    ("n45", "n13");
    ("n20", "n24");
    ("n34", "n49");
    ("n42", "n47");
    ("n40", "n36");
    ("n8", "n2");
    ("n7", "n47");
    ("n18", "n31");
    ("n30", "n5");
    ("n9", "n18");
    ("n48", "n32");
    ("n32", "n26");
    ("n42", "n5");
    ("n22", "n28");
    ("n25", "n6");
    ("n48", "n21");
    ("n42", "n0");
    ("n36", "n9");
    ("n41", "n46");
    ("n34", "n35");
    ("n44", "n1");
    ("n7", "n8");
    ("n48", "n45");
    ("n7", "n5");
    ("n42", "n1");
    ("n35", "n16");
    ("n5", "n38");
    ("n2", "n39");
    ("n41", "n48");
    ("n23", "n5");
    ("n25", "n45");
    ("n43", "n23");
    ("n14", "n27");
    ("n15", "n40");
    ("n30", "n28");
    ("n48", "n25");
    ("n42", "n11");
    ("n35", "n25");
    ("n19", "n4");
    ("n14", "n21");
    ("n6", "n48");
    ("n9", "n23");
    ("n22", "n35");
    ("n28", "n32");
    ("n7", "n16");
    ("n7", "n33");
    ("n7", "n4");
    ("n6", "n33");
    ("n25", "n43");
    ("n5", "n37");
    ("n5", "n33");
    ("n19", "n40");
    ("n34", "n14");
    ("n14", "n7");
    ("n22", "n43");
    ("n5", "n12");
    ("n43", "n26");
    ("n48", "n22");
    ("n40", "n2");
    ("n8", "n46");
    ("n37", "n14");
    ("n41", "n10");
    ("n20", "n15");
    ("n36", "n8");
    ("n7", "n42");
    ("n1", "n45");
    ("n1", "n6");
    ("n18", "n12");
    ("n31", "n34");
    ("n25", "n39");
    ("n19", "n1");
    ("n44", "n37");
    ("n7", "n12");
    ("n45", "n18");
    ("n46", "n38");
    ("n35", "n18");
    ("n23", "n24");
    ("n18", "n48");
    ("n30", "n17");
    ("n9", "n2");
    ("n33", "n45");
    ("n6", "n39");
    ("n16", "n30");
    ("n41", "n22");
    ("n35", "n47");
    ("n38", "n24");
    ("n44", "n10");
    ("n32", "n2");
    ("n40", "n43");
    ("n15", "n47");
    ("n9", "n7");
    ("n31", "n28");
    ("n29", "n25");
    ("n35", "n37");
    ("n32", "n35");
    ("n1", "n19");
    ("n35", "n34");
    ("n31", "n20");
    ("n35", "n17");
    ("n1", "n2");
    ("n6", "n44");
    ("n29", "n3");
    ("n41", "n45");
    ("n8", "n9");
    ("n45", "n31");
    ("n45", "n22");
    ("n37", "n27");
    ("n34", "n6");
    ("n36", "n25");
    ("n37", "n4");
    ("n42", "n41");
    ("n42", "n44");
    ("n48", "n27");
    ("n42", "n49");
    ("n8", "n6");
    ("n25", "n46");
    ("n28", "n26");
    ("n23", "n15");
    ("n30", "n40");
    ("n16", "n8");
    ("n14", "n2");
    ("n9", "n39");
    ("n36", "n3");
    ("n22", "n38");
    ("n30", "n22");
    ("n24", "n41");
    ("n14", "n35");
    ("n15", "n28");
    ("n24", "n39");
    ("n11", "n38");
    ("n45", "n48");
    ("n28", "n17");
    ("n28", "n9");
    ("n6", "n21");
    ("n28", "n46");
    ("n23", "n27");
    ("n33", "n13");
    ("n4", "n22");
    ("n5", "n39");
    ("n30", "n45");
    ("n39", "n21");
    ("n41", "n9");
    ("n18", "n22");
    ("n45", "n36");
    ("n4", "n49");
    ("n32", "n24");
    ("n32", "n29");
    ("n24", "n35");
    ("n27", "n32");
    ("n33", "n19");
    ("n42", "n32");
    ("n3", "n35");
    ("n8", "n16");
    ("n21", "n36");
    ("n14", "n36");
    ("n37", "n31");
    ("n14", "n16");
    ("n34", "n43");
    ("n28", "n34");
    ("n12", "n0");
    ("n29", "n24");
    ("n27", "n42");
    ("n22", "n26");
    ("n29", "n13");
    ("n22", "n45");
    ("n24", "n32");
    ("n40", "n46");
    ("n14", "n25");
    ("n4", "n7");
    ("n23", "n17");
    ("n7", "n9");
    ("n44", "n45");
    ("n16", "n45");
    ("n15", "n49");
    ("n2", "n49");
    ("n37", "n39");
    ("n28", "n14");
    ("n25", "n28");
    ("n5", "n49");
    ("n42", "n46");
    ("n24", "n43");
    ("n9", "n36");
    ("n5", "n9");
    ("n14", "n4");
    ("n19", "n28");
    ("n0", "n44");
    ("n4", "n48");
    ("n40", "n25");
    ("n37", "n23");
    ("n18", "n7");
    ("n40", "n32");
    ("n39", "n46");
    ("n48", "n10");
    ("n7", "n2");
    ("n34", "n26");
    ("n31", "n29");
    ("n41", "n24");
    ("n25", "n48");
    ("n41", "n21");
    ("n16", "n17");
    ("n15", "n19");
    ("n29", "n14");
    ("n45", "n2");
    ("n29", "n15");
    ("n24", "n23");
    ("n9", "n25");
    ("n27", "n41");
    ("n6", "n19");
    ("n48", "n42");
    ("n22", "n46");
    ("n7", "n44");
    ("n23", "n35");
    ("n38", "n5");
    ("n7", "n14");
    ("n9", "n8");
    ("n36", "n30");
    ("n45", "n12");
    ("n45", "n21");
    ("n45", "n17");
    ("n49", "n17");
    ("n8", "n34");
    ("n29", "n43");
    ("n42", "n23");
    ("n15", "n0");
    ("n38", "n27");
    ("n1", "n28");
    ("n15", "n1");
    ("n6", "n49");
    ("n1", "n20");
    ("n19", "n12");
    ("n32", "n16");
    ("n48", "n36");
    ("n12", "n33");
    ("n18", "n26");
    ("n33", "n30");
    ("n48", "n35");
    ("n14", "n3");
    ("n45", "n24");
    ("n25", "n15");
    ("n1", "n24");
    ("n29", "n33");
    ("n1", "n29");
    ("n31", "n39");
    ("n4", "n38");
    ("n14", "n30");
    ("n31", "n41");
    ("n17", "n10");
    ("n49", "n4");
    ("n2", "n22");
    ("n44", "n3");
    ("n14", "n28");
    ("n18", "n13");
    ("n1", "n10");
    ("n7", "n45");
    ("n6", "n40");
    ("n36", "n33");
    ("n18", "n38");
    ("n2", "n3");
    ("n23", "n45");
    ("n25", "n8");
    ("n39", "n2");
    ("n37", "n28");
    ("n37", "n0");
    ("n16", "n26");
    ("n35", "n41");
    ("n22", "n16");
    ("n48", "n41");
    ("n42", "n3");
    ("n12", "n11");
    ("n1", "n12");
    ("n30", "n7");
    ("n48", "n28");
    ("n1", "n49");
    ("n42", "n17");
    ("n5", "n45");
    ("n6", "n47");
    ("n18", "n32");
    ("n35", "n4");
    ("n14", "n47");
    ("n6", "n28");
    ("n7", "n46");
    ("n33", "n16");
    ("n12", "n44");
    ("n28", "n31");
    ("n36", "n41");
    ("n48", "n14");
    ("n19", "n0");
    ("n24", "n45");
    ("n1", "n30");
    ("n2", "n40");
    ("n4", "n32");
    ("n25", "n49");
    ("n9", "n30");
    ("n38", "n20");
    ("n24", "n37");
    ("n22", "n27");
    ("n9", "n15");
    ("n41", "n14");
    ("n36", "n35");
    ("n22", "n12");
    ("n37", "n46");
    ("n21", "n38");
    ("n30", "n23");
    ("n19", "n38");
    ("n30", "n18");
    ("n3", "n37");
    ("n33", "n34");
    ("n33", "n48");
    ("n28", "n49");
    ("n7", "n13");
    ("n33", "n27");
    ("n25", "n27");
    ("n9", "n28");
    ("n37", "n6");
    ("n11", "n42");
    ("n3", "n36");
    ("n2", "n34");
    ("n48", "n49");
    ("n34", "n22");
    ("n29", "n16");
    ("n40", "n23");
    ("n41", "n17");
    ("n19", "n9");
    ("n8", "n15");
    ("n34", "n31");
    ("n15", "n14");
    ("n36", "n7");
    ("n44", "n18");
    ("n18", "n14");
    ("n37", "n45");
    ("n35", "n43");
    ("n37", "n43");
    ("n49", "n48");
    ("n34", "n10");
    ("n36", "n49");
    ("n14", "n10");
    ("n6", "n32");
    ("n30", "n11");
    ("n41", "n26");
    ("n41", "n47");
    ("n1", "n17");
    ("n10", "n14");
    ("n48", "n15");
    ("n31", "n38");
    ("n1", "n11");
    ("n37", "n35");
    ("n23", "n36");
    ("n40", "n41");
    ("n49", "n16");
    ("n6", "n46");
    ("n41", "n1");
    ("n9", "n17");
    ("n34", "n21");
    ("n34", "n7");
    ("n14", "n45");
    ("n22", "n7");
    ("n22", "n8");
    ("n8", "n17");
    ("n35", "n13");
    ("n19", "n34");
    ("n24", "n40");
    ("n2", "n16");
    ("n6", "n20");
    ("n42", "n30");
    ("n33", "n36");
    ("n35", "n38");
    ("n30", "n38");
    ("n34", "n42");
    ("n40", "n12");
    ("n6", "n8");
    ("n42", "n37");
    ("n19", "n8");
    ("n4", "n3");
    ("n22", "n36");
    ("n26", "n25");
    ("n30", "n48");
    ("n16", "n49");
    ("n4", "n30");
    ("n1", "n43");
    ("n30", "n33");
    ("n2", "n37");
    ("n19", "n31");
    ("n48", "n29");
    ("n14", "n12");
    ("n24", "n1");
    ("n7", "n19");
    ("n44", "n48");
    ("n32", "n38");
    ("n49", "n39");
    ("n32", "n25");
    ("n14", "n6");
    ("n45", "n25");
    ("n41", "n20");
    ("n34", "n48");
    ("n5", "n19");
    ("n8", "n41");
    ("n16", "n11");
    ("n1", "n44");
    ("n21", "n35");
    ("n7", "n22");
    ("n3", "n34");
    ("n33", "n0");
    ("n9", "n35");
    ("n23", "n0");
    ("n40", "n1");
    ("n1", "n14");
    ("n25", "n29");
    ("n9", "n41");
    ("n15", "n23");
    ("n31", "n48");
    ("n2", "n38");
    ("n36", "n32");
    ("n45", "n30");
    ("n48", "n6");
    ("n8", "n27");
    ("n38", "n35");
    ("n20", "n7");
    ("n24", "n28");
    ("n15", "n34");
    ("n45", "n46");
    ("n2", "n8");
    ("n36", "n43");
    ("n33", "n47");
    ("n1", "n41");
    ("n18", "n39");
    ("n3", "n22");
    ("n8", "n35");
    ("n7", "n23");
    ("n6", "n30");
    ("n27", "n5");
    ("n19", "n33");
    ("n8", "n45");
    ("n45", "n40");
    ("n8", "n20");
    ("n38", "n12");
    ("n48", "n47");
    ("n15", "n27");
    ("n6", "n4");
    ("n30", "n8");
    ("n24", "n44");
    ("n49", "n45");
    ("n6", "n5");
    ("n7", "n24");
    ("n28", "n45");
    ("n5", "n4");
    ("n8", "n32");
    ("n40", "n38");
    ("n6", "n24");
    ("n42", "n12");
    ("n37", "n1");
    ("n6", "n1");
    ("n32", "n39");
    ("n38", "n4");
    ("n11", "n2");
    ("n6", "n34");
    ("n7", "n49");
    ("n45", "n34");
    ("n36", "n34");
    ("n36", "n18");
    ("n32", "n23");
    ("n1", "n46");
    ("n42", "n7");
    ("n45", "n15");
    ("n28", "n23");
    ("n45", "n8");
    ("n25", "n38");
    ("n36", "n20");
    ("n47", "n30");
    ("n3", "n4");
    ("n9", "n45");
    ("n16", "n27");
    ("n6", "n3");
    ("n41", "n30");
    ("n37", "n11");
    ("n32", "n44");
    ("n18", "n24");
    ("n34", "n9");
    ("n2", "n33");
    ("n16", "n24");
    ("n25", "n9");
    ("n24", "n11");
    ("n11", "n9");
    ("n15", "n25");
    ("n15", "n22");
    ("n48", "n40");
    ("n34", "n0");
    ("n2", "n29");
    ("n35", "n0");
    ("n32", "n19");
    ("n42", "n2");
    ("n22", "n9");
    ("n28", "n38");
    ("n41", "n8");
    ("n17", "n38");
    ("n13", "n45");
    ("n30", "n34");
    ("n36", "n31");
    ("n11", "n39");
    ("n39", "n12");
    ("n28", "n19");
    ("n34", "n37");
    ("n37", "n24");
    ("n9", "n38");
    ("n4", "n10");
    ("n37", "n21");
    ("n4", "n5");
    ("n22", "n33");
    ("n30", "n31");
    ("n25", "n26");
    ("n42", "n35");
    ("n12", "n3");
    ("n15", "n18");
    ("n7", "n15");
    ("n1", "n18");
    ("n23", "n31");
    ("n28", "n48");
    ("n4", "n1");
    ("n48", "n3");
    ("n41", "n3");
    ("n3", "n29");
    ("n44", "n14");
    ("n14", "n44");
    ("n1", "n23");
    ("n41", "n12");
    ("n36", "n42");
    ("n45", "n11");
    ("n38", "n1");
    ("n19", "n27");
    ("n6", "n27");
    ("n31", "n49");
    ("n4", "n2");
    ("n22", "n14");
    ("n3", "n44");
    ("n42", "n45");
    ("n24", "n2");
    ("n15", "n4");
    ("n41", "n6");
    ("n15", "n42");
    ("n11", "n36");
    ("n37", "n47");
    ("n40", "n26");
    ("n9", "n0");
    ("n34", "n16");
    ("n30", "n43");
    ("n14", "n20");
    ("n1", "n40");
    ("n37", "n15");
    ("n1", "n5");
    ("n41", "n11");
    ("n15", "n36");
    ("n1", "n36");
    ("n15", "n37");
    ("n45", "n0");
    ("n15", "n7");
    ("n22", "n32");
    ("n41", "n35");
    ("n22", "n29");
    ("n15", "n12");
    ("n48", "n1");
    ("n32", "n41");
    ("n48", "n20");
    ("n30", "n24");
    ("n9", "n26");
    ("n40", "n3");
    ("n7", "n21");
    ("n4", "n17");
    ("n2", "n9");
    ("n1", "n7");
    ("n36", "n28");
    ("n30", "n46");
    ("n4", "n12");
    ("n12", "n5");
    ("n11", "n10");
    ("n28", "n6");
    ("n25", "n0");
    ("n16", "n29");
    ("n27", "n22");
    ("n7", "n18");
    ("n14", "n0");
    ("n14", "n49");
    ("n14", "n1");
    ("n43", "n32");
    ("n48", "n5");
    ("n18", "n27");
    ("n42", "n18");
    ("n33", "n17");
    ("n28", "n39");
    ("n28", "n18");
    ("n47", "n10");
    ("n1", "n25");
    ("n1", "n47");
    ("n28", "n13");
    ("n19", "n44");
    ("n5", "n14");
    ("n4", "n27");
    ("n4", "n44");
    ("n32", "n6");
    ("n35", "n49");
    ("n16", "n34");
    ("n1", "n0");
    ("n4", "n11");
    ("n12", "n4");
    ("n29", "n2");
    ("n3", "n11");
    ("n45", "n49");
    ("n24", "n18");
    ("n3", "n43");
    ("n38", "n40");
    ("n32", "n21");
    ("n10", "n38");
    ("n30", "n15");
    ("n32", "n45");
    ("n48", "n26");
    ("n14", "n5");
    ("n30", "n27");
    ("n38", "n22");
  ]

let pr1 =
  List.fold_left
    (fun acc node -> PageRank.add node (1.0 /. 5.0) acc)
    PageRank.empty
    [ "n0"; "n1"; "n2"; "n3"; "n4" ]

let pr2 =
  List.fold_left
    (fun acc node -> PageRank.add node (1.0 /. 50.0) acc)
    PageRank.empty
    [
      "n0";
      "n1";
      "n2";
      "n3";
      "n4";
      "n5";
      "n6";
      "n7";
      "n8";
      "n9";
      "n10";
      "n11";
      "n12";
      "n13";
      "n14";
      "n15";
      "n16";
      "n17";
      "n18";
      "n19";
      "n20";
      "n21";
      "n22";
      "n23";
      "n24";
      "n25";
      "n26";
      "n27";
      "n28";
      "n29";
      "n30";
      "n31";
      "n32";
      "n33";
      "n34";
      "n35";
      "n36";
      "n37";
      "n38";
      "n39";
      "n40";
      "n41";
      "n42";
      "n43";
      "n44";
      "n45";
      "n46";
      "n47";
      "n48";
      "n49";
    ]

let damping = 0.85
let delta_1 = 0.1
let delta_2 = 0.001

let expected_ranks_1 =
  [
    ("n0", 8509.0 /. 36000.0);
    ("n1", 18769.0 /. 72000.0);
    ("n2", 913.0 /. 7200.0);
    ("n3", 1849.0 /. 18000.0);
    ("n4", 19687.0 /. 72000.0);
  ]

let expected_ranks_2 =
  [
    ("n0", 302507378323377069728158244261. /. 13161171837128310400204800000000.);
    ("n1", 688070290313905271110680597617. /. 37023260158890891325440000000000.);
    ("n10", 8196854688498226642967658131. /. 309205249678649202278400000000.);
    ("n11", 497410420848213410799901123279. /. 34793902557925418299392000000000.);
    ("n12", 187238073579445098221448366187. /. 9970584725097204848640000000000.);
    ( "n13",
      1253737708644783590535953012693. /. 123635250591205340123136000000000. );
    ( "n14",
      32708276292639962594178483917909. /. 1359987756503258741354496000000000.
    );
    ( "n15",
      27849992722117129186713588271513. /. 1737762133309719502841856000000000.
    );
    ("n16", 64605516104662859136554115439. /. 3988233890038881939456000000000.);
    ("n17", 239172537164482462819031219. /. 11586381138170302464000000000.);
    ( "n18",
      1998489462038545667482443512051. /. 129361945407671427010560000000000. );
    ("n19", 404187279690587764135565005679. /. 23648980644839932750368000000000.);
    ( "n2",
      2619861754955551495578208022651. /. 154544063239006675153920000000000. );
    ("n20", 888242461762830897796406277223. /. 63949267547175175925760000000000.);
    ( "n21",
      2093195647666871133127884719029. /. 156921664211914470156288000000000. );
    ( "n22",
      150392292679568326577167528239181. /. 7109026908994307057080320000000000.
    );
    ( "n23",
      23188009712135596860202319125181. /. 1164257508669042843095040000000000.
    );
    ( "n24",
      25982777565064251964384650025049. /. 957542399986988297484288000000000. );
    ( "n25",
      6779264928018885977888179600483. /. 283330782604845571115520000000000. );
    ( "n26",
      5325919252358422228375510439791. /. 234480647672975645061120000000000. );
    ( "n27",
      1040302069307936349951894095327. /. 50559889654485373466304000000000. );
    ( "n28",
      455701456606001596070785179698389. /. 16179164689435319509217280000000000.
    );
    ("n29", 20561879801381166080837363363. /. 1421094834381670576128000000000.);
    ( "n3",
      42358314969035474564533931036087. /. 2549977043443610140039680000000000.
    );
    ("n30", 49912702984512279879988246651. /. 2062879598295973416960000000000.);
    ("n31", 187614939091529054894429838647. /. 13382270214586699345920000000000.);
    ( "n32",
      1299501847645833649333312230739. /. 63949267547175175925760000000000. );
    ( "n33",
      5783129239775653149352164033913. /. 343985173015853567278080000000000. );
    ("n34", 133932646627961390587287190847. /. 6778032965829626941440000000000.);
    ("n35", 476706831819671513844537361. /. 21808095951727645560000000000.);
    ( "n36",
      857674823858464453855189511924191. /. 42654161453965842342481920000000000.
    );
    ("n37", 377054842310442433110578775241. /. 26322343674256620800409600000000.);
    ( "n38",
      3529180684709451296248436785909. /. 91729379470894284607488000000000. );
    ("n39", 57906834596012581086055228739. /. 3381932418360225649920000000000.);
    ("n4", 340486050764096234554624560487. /. 16451464796410388000256000000000.);
    ("n40", 476279430774797401727417155001. /. 24891022599131260783411200000000.);
    ("n41", 4390958894384356582600917551. /. 245016350755460444160000000000.);
    ( "n42",
      1264220872668388910935322011463. /. 74724602005673557217280000000000. );
    ( "n43",
      3094248526357271894104902761791. /. 173969512789627091496960000000000. );
    ( "n44",
      108952733746178950492814325102607. /. 2914259478221268731473920000000000.
    );
    ( "n45",
      287309647421339356935939597725849. /. 7819929599893737762788352000000000.
    );
    ( "n46",
      739738733054571461863044746179129. /. 33513983999544590411950080000000000.
    );
    ( "n47",
      3679224204703422310325564669279. /. 313843328423828940312576000000000. );
    ("n48", 830136969452057943981625354897. /. 40146810643760098037760000000000.);
    ("n49", 639340717630470285506860108781. /. 35664014593616925035520000000000.);
    ( "n5",
      22663231388813780080038469020203. /. 1218690327256166924070912000000000.
    );
    ("n6", 679394228118153924446465338067. /. 46896129534595129012224000000000.);
    ("n7", 872629023889498409184100265779. /. 35019836990119739197440000000000.);
    ( "n8",
      31512623899776379795537243978717. /. 1375940692063414269112320000000000.
    );
    ("n9", 24497639464488649340295135893. /. 1812833586381309972480000000000.);
  ]

let round_float f =
  let factor = 10000.0 in
  floor ((f *. factor) +. 0.5) /. factor

let test_iter_pagerank_1 () =
  let computed_ranks = iterPageRank pr1 damping g1 delta_1 in
  List.iter
    (fun (node, expected) ->
      let actual = PageRank.find node computed_ranks |> round_float in
      let expected = round_float expected in
      check (float 0.0001) ("PageRank for " ^ node) expected actual)
    expected_ranks_1

let test_iter_pagerank_2 () =
  let computed_ranks = iterPageRank pr2 damping g2 delta_2 in
  List.iter
    (fun (node, expected) ->
      let actual = PageRank.find node computed_ranks |> round_float in
      let expected = round_float expected in
      check (float 0.0001) ("PageRank for " ^ node) expected actual)
    expected_ranks_2

let () =
  run "iterPageRank Tests"
    [
      ( "iterPageRank_1",
        [
          test_case "Test iterative pagerank on g1/pr1" `Quick
            test_iter_pagerank_1;
        ] );
      ( "iterPageRank_2",
        [
          test_case "Test iterative pagerank on g2/pr2" `Quick
            test_iter_pagerank_2;
        ] );
    ]
